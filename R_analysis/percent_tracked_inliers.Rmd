---
title: "move_times"
output: html_document
date: "2024-04-26"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Analysis script for "

```{r load libraries}
library(readr)
library(tidyverse)
library(ggpubr)
library(rstatix)
library(stats)
library(lme4)
library(dplyr)
library(ez)
library(ltm)
library(interactions)
library(lmerTest)
# library(viridis)
# library(hrbrthemes)
```


## Extract dataframe from csv file and get (mean, sd) or (mean, se) summary

```{r read csv}

setwd("C:/Users/micha/OneDrive/ETH_GitHub_Repos/rpg_trajectory_evaluation/R_analysis/kitti_data/")
task_df <- read_csv("all_percentages.csv")

detector_order <- c("sift", "harris", "shi_tomasi")

# Reorder the factor levels
task_df$detector <- factor(task_df$detector, levels = detector_order)


######################### get mean and sd (or se) ######################### 
task_df %>%
  group_by(detector) %>%
  get_summary_stats(tracked, type = "mean_sd")



```

## Plots

```{r do plotting}

bxp1 <- ggboxplot(
  task_df, x = "detector", y = "tracked", palette = "jco", outlier.shape = NA
  ) + ylim(0.85, 1.05)
bxp1

bxp1 <- ggboxplot(
  task_df, x = "detector", y = "inliers", palette = "jco", outlier.shape = NA
  ) + ylim(0.8, 1.05)
bxp1


# # Plot
# task_df %>%
#   ggplot( aes(x=detector, y=tracked)) +
#     geom_boxplot() +
#     geom_jitter(color="black", size=0.4, alpha=0.9) +
#     theme(
#       legend.position="none",
#       plot.title = element_text(size=11)
#     ) +
#     ggtitle("A boxplot with jitter") +
#     xlab("")

```


## Check assumptions

```{r check assumptions}

# ######################### check for outliers ######################### 
# task_df %>%
#   group_by(dist_factor) %>%
#   identify_outliers(trans_err)
# 
# ######################### check normality ######################### 
# task_df %>%
#   group_by(auto_level, ring_id) %>%
#   shapiro_test(average_mt)
# 
# ######################### plot normality ######################### 
# ggqqplot(task_df, "average_mt", ggtheme = theme_bw()) +
#   facet_grid(ring_id ~ auto_level, labeller = "label_both")


```


## Fit ANOVA

```{r fit model}

######################### Two-way mixed ANOVA test #########################  
res.aov <- anova_test(
  data = task_df, dv = tracked, wid = frame_id,
  within = detector
  )
get_anova_table(res.aov)

pwc1 <- task_df %>%
  t_test(
    tracked ~ detector,
    p.adjust.method = "holm"
    )
pwc1


######################### Two-way mixed ANOVA test #########################  
res.aov <- anova_test(
  data = task_df, dv = inliers, wid = frame_id,
  within = detector
  )
get_anova_table(res.aov)

pwc2 <- task_df %>%
  t_test(
    inliers ~ detector,
    p.adjust.method = "holm"
    )
pwc2



```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
